import{a as G,t as P,l as N}from"./formatting.BlF5Q6x7.js";import{g as Q,E as W,T as X}from"./index.B1zJWTyT.js";import{s as Y,b as k,j as F,f as y,F as q,K as O,v as Z,e as w,t as $,a as ee,d as S,r as T,u as te,c as ne,i as d,T as A,k as g,x as ie,a6 as oe,E as se,z as le,A as ue,B as ae,L as re,G as I,H as U,n as fe}from"./scheduler.v_cXcvRN.js";import{S as ce,i as de,t as D,g as me,a as C,c as he,f as x}from"./index.CQNOboDd.js";import{q as _e}from"./VennDiagram.svelte_svelte_type_style_lang.CxDuzjD8.js";import{f as z}from"./index.CpChHC2s.js";function pe(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function*ye(n,e){if(e===void 0)for(let t of n)t!=null&&(t=+t)>=t&&(yield t);else{let t=-1;for(let i of n)(i=e(i,++t,n))!=null&&(i=+i)>=i&&(yield i)}}class be{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let i=0;for(let o=0;o<this._n&&o<32;o++){const s=t[o],u=e+s,l=Math.abs(e)<Math.abs(s)?e-(u-s):s-(u-e);l&&(t[i++]=l),e=u}return t[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let t=this._n,i,o,s,u=0;if(t>0){for(u=e[--t];t>0&&(i=u,o=e[--t],u=i+o,s=o-(u-i),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(o=s*2,i=u+o,o==i-u&&(u=i))}return u}}function J(n,e){const t=new be;if(e===void 0)for(let i of n)(i=+i)&&t.add(i);else{let i=-1;for(let o of n)(o=+e(o,++i,n))&&t.add(o)}return+t}function E(n,e){let t;if(e===void 0)for(const i of n)i!=null&&(t<i||t===void 0&&i>=i)&&(t=i);else{let i=-1;for(let o of n)(o=e(o,++i,n))!=null&&(t<o||t===void 0&&o>=o)&&(t=o)}return t}function M(n,e){let t;if(e===void 0)for(const i of n)i!=null&&(t>i||t===void 0&&i>=i)&&(t=i);else{let i=-1;for(let o of n)(o=e(o,++i,n))!=null&&(t>o||t===void 0&&o>=o)&&(t=o)}return t}function V(n,e,t=0,i=n.length-1,o=pe){for(;i>t;){if(i-t>600){const a=i-t+1,m=e-t+1,p=Math.log(a),h=.5*Math.exp(2*p/3),r=.5*Math.sqrt(p*h*(a-h)/a)*(m-a/2<0?-1:1),c=Math.max(t,Math.floor(e-m*h/a+r)),f=Math.min(i,Math.floor(e+(a-m)*h/a+r));V(n,e,c,f,o)}const s=n[e];let u=t,l=i;for(b(n,t,e),o(n[i],s)>0&&b(n,t,i);u<l;){for(b(n,u,l),++u,--l;o(n[u],s)<0;)++u;for(;o(n[l],s)>0;)--l}o(n[t],s)===0?b(n,t,l):(++l,b(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}return n}function b(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function ge(n,e,t){if(n=Float64Array.from(ye(n,t)),!!(i=n.length)){if((e=+e)<=0||i<2)return M(n);if(e>=1)return E(n);var i,o=(i-1)*e,s=Math.floor(o),u=E(V(n,s).subarray(0,s+1)),l=M(n.subarray(s+1));return u+(l-u)*(o-s)}}function Te(n,e){return ge(n,.5,e)}function L(n,e){return i=>{e=e??{};const o={},s=Object.keys(n);for(const u of s)o[u]=n[u](i);if(e.rest&&i.length){const u=Object.keys(i[0]);for(const l of u)s.includes(l)||(o[l]=e.rest(l)(i))}return[o]}}function B(n){if(n!=null&&n.predicate){const e=n.predicate;return t=>t.reduce((i,o,s)=>e(o,s,t)?i+1:i,0)}return e=>e.length}function ve(n,e){let t=typeof n=="function"?n:i=>i[n];return i=>J(i,t)}function De(n,e){let t=0;for(let i=0;i<n.length;++i){const o=e(n[i],i,n);+o===o&&(t+=1)}return t?J(n,e)/t:void 0}function we(n){const e=typeof n=="function"?n:t=>t[n];return t=>M(t,e)}function Se(n){const e=typeof n=="function"?n:t=>t[n];return t=>E(t,e)}function Ce(n){const e=typeof n=="function"?n:t=>t[n];return t=>De(t,e)}function Ee(n){const e=typeof n=="function"?n:t=>t[n];return t=>Te(t,e)}function R(n,e={}){const t=typeof n=="function"?n:i=>i[n];return i=>{const o=new Map;let s=0,u=0;for(const l of i){const a=t(l,u++,i);if(!o.has(a)){if(!e.includeUndefined&&a===void 0||e.includeNull===!1&&a===null)continue;s+=1,o.set(a,!0)}}return s}}function Me(n,e){let t=G(n,e),i=["id","gdp"],o=["of","the","and","in","on"];function s(u){return u.replace(/\S*/g,function(l){return!i.includes(l)&&!o.includes(l)?l.charAt(0).toUpperCase()+l.substr(1).toLowerCase():i.includes(l)?l.toUpperCase():l.toLowerCase()})}return t=s(n.replace(/"/g,"").replace(/_/g," ")),t}function K(n,e,t=!0){const i=P(n,L(t?{count:B(e),countDistinct:R(e),min:we(e),max:Se(e),median:Ee(e),mean:Ce(e),sum:ve(e)}:{count:B(e),countDistinct:R(e)}))[0],{maxDecimals:o,unitType:s}=Fe(n.map(u=>u[e]));return{min:i.min,max:i.max,median:i.median,mean:i.mean,count:i.count,countDistinct:i.countDistinct,sum:i.sum,maxDecimals:o,unitType:s}}function Fe(n){var e;if(n==null||n.length===0)return{maxDecimals:0,unitType:"unknown"};{let t=0;for(const i of n){const o=(e=i==null?void 0:i.toString().split(".")[1])==null?void 0:e.length;o>t&&(t=o)}return{maxDecimals:t,unitType:"number"}}}function Le(n,e="object"){const t={},i=Q(n);for(const o of Object.keys(n[0])){const s=i.find(m=>{var p;return((p=m.name)==null?void 0:p.toLowerCase())===(o==null?void 0:o.toLowerCase())})??{name:o,evidenceType:W.NUMBER,typeFidelity:X.INFERRED},u=s.evidenceType;let l=s.evidenceType==="number"?K(n,o,!0):K(n,o,!1);s.evidenceType!=="number"&&(l.maxDecimals=0,l.unitType=s.evidenceType);const a=N(o,s,l);t[o]={title:Me(o,a),type:u,evidenceColumnType:s,format:a,columnUnitSummary:l}}return e!=="object"?Object.entries(t).map(([o,s])=>({id:o,...s})):t}function H(n){let e,t,i,o,s,u,l,a,m,p;const h=n[7].default,r=Z(h,n,n[6],null),c=r||je();return{c(){e=w("div"),t=w("button"),i=w("span"),o=$(n[2]),s=ee(),c&&c.c(),this.h()},l(f){e=S(f,"DIV",{});var _=T(e);t=S(_,"BUTTON",{type:!0,"aria-label":!0,class:!0});var v=T(t);i=S(v,"SPAN",{});var j=T(i);o=te(j,n[2]),j.forEach(y),s=ne(v),c&&c.l(v),v.forEach(y),_.forEach(y),this.h()},h(){d(t,"type","button"),d(t,"aria-label",n[2]),d(t,"class",u=A(n[4].class)+" svelte-p80uux")},m(f,_){F(f,e,_),g(e,t),g(t,i),g(i,o),g(t,s),c&&c.m(t,null),a=!0,m||(p=ie(t,"click",function(){oe(n[3](n[1]))&&n[3](n[1]).apply(this,arguments)}),m=!0)},p(f,_){n=f,(!a||_&4)&&se(o,n[2]),r&&r.p&&(!a||_&64)&&le(r,h,n,n[6],a?ae(h,n[6],_,null):ue(n[6]),null),(!a||_&4)&&d(t,"aria-label",n[2]),(!a||_&16&&u!==(u=A(n[4].class)+" svelte-p80uux"))&&d(t,"class",u)},i(f){a||(D(c,f),f&&re(()=>{a&&(l||(l=x(e,z,{duration:200},!0)),l.run(1))}),a=!0)},o(f){C(c,f),f&&(l||(l=x(e,z,{duration:200},!1)),l.run(0)),a=!1},d(f){f&&y(e),c&&c.d(f),f&&l&&l.end(),m=!1,p()}}}function je(n){let e,t;return{c(){e=I("svg"),t=I("path"),this.h()},l(i){e=U(i,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0});var o=T(e);t=U(o,"path",{d:!0}),T(t).forEach(y),o.forEach(y),this.h()},h(){d(t,"d","M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"),d(e,"width","12"),d(e,"height","12"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke-width","2"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round")},m(i,o){F(i,e,o),g(e,t)},p:fe,d(i){i&&y(e)}}}function ke(n){let e,t,i=n[0]&&H(n);return{c(){i&&i.c(),e=k()},l(o){i&&i.l(o),e=k()},m(o,s){i&&i.m(o,s),F(o,e,s),t=!0},p(o,[s]){o[0]?i?(i.p(o,s),s&1&&D(i,1)):(i=H(o),i.c(),D(i,1),i.m(e.parentNode,e)):i&&(me(),C(i,1,1,()=>{i=null}),he())},i(o){t||(D(i),t=!0)},o(o){C(i),t=!1},d(o){o&&y(e),i&&i.d(o)}}}function qe(n,e,t){let{$$slots:i={},$$scope:o}=e,{data:s=void 0}=e,{queryID:u=void 0}=e,{text:l="Download"}=e,{display:a=!0}=e;const m=new Date,p=new Date(m.getTime()-m.getTimezoneOffset()*6e4).toISOString().slice(0,19).replaceAll(":","-");let{downloadData:h=r=>{const c={fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,filename:(u??"evidence_download")+` ${p}`,useTextFile:!1,useBom:!0,useKeysAsHeaders:!0},f=JSON.parse(JSON.stringify(Array.from(r)));new _e.ExportToCsv(c).generateCsv(f)}}=e;return n.$$set=r=>{t(4,e=q(q({},e),O(r))),"data"in r&&t(1,s=r.data),"queryID"in r&&t(5,u=r.queryID),"text"in r&&t(2,l=r.text),"display"in r&&t(0,a=r.display),"downloadData"in r&&t(3,h=r.downloadData),"$$scope"in r&&t(6,o=r.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&t(0,a=a==="true"||a===!0)},e=O(e),[a,s,l,h,e,u,o,i]}class Be extends ce{constructor(e){super(),de(this,e,qe,ke,Y,{data:1,queryID:5,text:2,display:0,downloadData:3})}}export{Be as D,Me as f,Le as g};
